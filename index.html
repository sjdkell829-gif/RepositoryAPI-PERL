<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Anime Power Levels API</title>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: white; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        .card { background: #333; padding: 15px; border-radius: 8px; border-left: 5px solid #00ffcc; }
        form { background: #222; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        input, button { display: block; width: 100%; margin: 10px 0; padding: 10px; border-radius: 4px; border: none; }
        button { background: #00ffcc; color: #000; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Anime Stats ⚡</h1>
    <form id="animeForm">
        <input type="text" id="nombre" placeholder="Nombre (ej. Goku)" required>
        <input type="text" id="universo" placeholder="Universo" required>
        <input type="text" id="nivel_poder" placeholder="Poder (ej. Nivel Dios)" required>
        <button type="submit">Registrar Personaje</button>
    </form>
    <div class="grid" id="lista"></div>

    <script>
        const apiURL = '/cgi-bin/api.pl';
function cargar() {
    fetch('/cgi-bin/api.pl')
        .then(r => r.json())
        .then(resultado => {
            const lista = document.getElementById('lista'); // o el ID que uses
            lista.innerHTML = '';
            
            // EL SECRETO: entrar a .data
            if(resultado.data && Array.isArray(resultado.data)) {
                resultado.data.forEach(p => {
                    lista.innerHTML += `<div class="card"><h3>${p.nombre}</h3><p>${p.nivel_poder}</p></div>`;
                });
            }
        });
}
        document.getElementById('animeForm').onsubmit = (e) => {
            e.preventDefault();
            const data = {
                nombre: document.getElementById('nombre').value,
                universo: document.getElementById('universo').value,
                nivel_poder: document.getElementById('nivel_poder').value,
                estado: "Vivo"
            };
            fetch(apiURL, { method: 'POST', body: JSON.stringify(data) }).then(() => {
                alert("¡Guardado!");
                cargar();
            });
        };
        cargar();
    </script>
</body>
</html>